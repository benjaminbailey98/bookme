
{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the Vibe Request application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user.",
          "format": "email"
        },
        "registrationDate": {
          "type": "string",
          "description": "Date and time when the user registered.",
          "format": "date-time"
        },
        "isVenue": {
          "type": "boolean",
          "description": "Indicates whether the user is registered as a venue."
        },
        "isAdmin": {
          "type": "boolean",
          "description": "Indicates whether the user has administrator privileges."
        }
      },
      "required": [
        "id",
        "email",
        "registrationDate"
      ]
    },
    "VenueProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "VenueProfile",
      "type": "object",
      "description": "Represents a venue profile in the Vibe Request application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the VenueProfile entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:1 VenueProfile)"
        },
        "companyName": {
          "type": "string",
          "description": "Name of the company."
        },
        "companyEmail": {
          "type": "string",
          "description": "Email address of the company.",
          "format": "email"
        },
        "companyPhone": {
          "type": "string",
          "description": "Phone number of the company."
        },
        "companyLogoUrl": {
          "type": "string",
          "description": "URL of the company logo.",
          "format": "uri"
        },
        "companyAddress": {
          "type": "string",
          "description": "Address of the company."
        },
        "businessHours": {
          "type": "string",
          "description": "Business hours of the venue (e.g., Mon-Fri: 9am-5pm)."
        },
        "contactTitle": {
          "type": "string",
          "description": "Title of the contact person."
        },
        "contactName": {
          "type": "string",
          "description": "Name of the contact person."
        },
        "contactEmail": {
          "type": "string",
          "description": "Email of the contact person.",
          "format": "email"
        },
        "contactPhone": {
          "type": "string",
          "description": "Phone number of the contact person."
        }
      },
      "required": [
        "id",
        "userId",
        "companyName",
        "companyEmail",
        "companyPhone",
        "companyAddress",
        "businessHours",
        "contactTitle",
        "contactName",
        "contactEmail",
        "contactPhone"
      ]
    },
    "ArtistProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ArtistProfile",
      "type": "object",
      "description": "Represents an artist profile in the Vibe Request application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the ArtistProfile entity."
        },
        "userId": {
          "type": "string",
          "description": "The ID of the user who owns this profile. (Relationship: User 1:1 ArtistProfile)"
        },
        "stageName": {
          "type": "string",
          "description": "Artist's stage name."
        },
        "realName": {
          "type": "string",
          "description": "Artist's real name."
        },
        "personalEmail": {
          "type": "string",
          "description": "Artist's personal email address.",
          "format": "email"
        },
        "personalPhone": {
          "type": "string",
          "description": "Artist's personal phone number."
        },
        "shortBio": {
          "type": "string",
          "description": "Short biography of the artist."
        },
        "websiteUrl": {
          "type": "string",
          "description": "URL of the artist's website.",
          "format": "uri"
        },
        "instagramUrl": {
          "type": "string",
          "description": "URL of the artist's Instagram profile.",
          "format": "uri"
        },
        "facebookUrl": {
          "type": "string",
          "description": "URL of the artist's Facebook page.",
          "format": "uri"
        },
        "youtubeUrl": {
          "type": "string",
          "description": "URL of the artist's YouTube channel.",
          "format": "uri"
        },
        "spotifyUrl": {
          "type": "string",
          "description": "URL of the artist's Spotify profile.",
          "format": "uri"
        },
        "managementCompanyName": {
          "type": "string",
          "description": "Name of the artist's management company."
        },
        "managementContactPerson": {
          "type": "string",
          "description": "Contact person at the management company."
        },
        "managementEmail": {
          "type": "string",
          "description": "Email address of the management company.",
          "format": "email"
        },
        "managementPhone": {
          "type": "string",
          "description": "Phone number of the management company."
        },
        "artistProfilePictureUrl": {
          "type": "string",
          "description": "URL to the profile picture of the artist",
          "format": "uri"
        },
        "artistPerformingVideoUrl": {
          "type": "string",
          "description": "URL to a 2min (max) video of the artist performing",
          "format": "uri"
        }
      },
      "required": [
        "id",
        "userId",
        "stageName",
        "realName",
        "personalEmail",
        "personalPhone",
        "shortBio"
      ]
    },
    "BookingRequest": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "BookingRequest",
      "type": "object",
      "description": "Represents a booking request submitted by a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the BookingRequest entity."
        },
        "venueProfileId": {
          "type": "string",
          "description": "Reference to VenueProfile. (Relationship: VenueProfile 1:N BookingRequest)"
        },
        "artistProfileId": {
          "type": "string",
          "description": "Reference to ArtistProfile. (Relationship: ArtistProfile 1:N BookingRequest)"
        },
        "eventDate": {
          "type": "string",
          "description": "Date of the event.",
          "format": "date-time"
        },
        "eventTime": {
          "type": "string",
          "description": "Time of the event."
        },
        "lengthOfEvent": {
          "type": "number",
          "description": "Length of the event in hours."
        },
        "lengthOfPerformance": {
          "type": "number",
          "description": "Length of the performance in hours."
        },
        "venueName": {
          "type": "string",
          "description": "Name of the venue where the event will be held."
        },
        "locationAddress": {
          "type": "string",
          "description": "Address of the location where the event will be held."
        },
        "contactName": {
          "type": "string",
          "description": "Contact name for the event."
        },
        "contactPhone": {
          "type": "string",
          "description": "Contact phone number for the event."
        },
        "contactEmail": {
          "type": "string",
          "description": "Contact email for the event.",
          "format": "email"
        },
        "eventType": {
          "type": "string",
          "description": "Type of event (e.g., Wedding, Concert)."
        },
        "attire": {
          "type": "string",
          "description": "Attire for the event (optional)."
        },
        "eventTheme": {
          "type": "string",
          "description": "Theme of the event (optional)."
        },
        "liveEntertainmentBudget": {
          "type": "number",
          "description": "Budget for live entertainment."
        },
        "isTicketedEvent": {
          "type": "boolean",
          "description": "Indicates whether the event is ticketed."
        },
        "ticketPrices": {
          "type": "string",
          "description": "Ticket prices for the event."
        },
        "entertainmentType": {
          "type": "string",
          "description": "Type of entertainment requested (e.g., Featured Artist)."
        },
        "liveBandProvidedBy": {
          "type": "string",
          "description": "Who provides the live band (Venue or Artist)."
        },
        "soundProvidedBy": {
          "type": "string",
          "description": "Who provides the sound equipment (Venue or Artist)."
        },
        "referralInfo": {
          "type": "string",
          "description": "Information about who referred the user"
        },
        "venueOwnerId": {
            "type": "string",
            "description": "Denormalized user ID of the venue owner for security rules."
        }
      },
      "required": [
        "id",
        "venueProfileId",
        "artistProfileId",
        "eventDate",
        "eventTime",
        "lengthOfEvent",
        "lengthOfPerformance",
        "venueName",
        "locationAddress",
        "contactName",
        "contactPhone",
        "contactEmail",
        "eventType",
        "liveEntertainmentBudget",
        "entertainmentType"
      ]
    },
    "ArtistAvailability": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ArtistAvailability",
      "type": "object",
      "description": "Represents the availability of an artist.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the ArtistAvailability entity."
        },
        "artistProfileId": {
          "type": "string",
          "description": "Reference to ArtistProfile. (Relationship: ArtistProfile 1:N ArtistAvailability)"
        },
        "unavailableDate": {
          "type": "string",
          "description": "Date when the artist is unavailable.",
          "format": "date-time"
        },
        "unavailableStartTime": {
          "type": "string",
          "description": "Start time when the artist is unavailable."
        },
        "unavailableEndTime": {
          "type": "string",
          "description": "End time when the artist is unavailable."
        },
        "isAllDay": {
          "type": "boolean",
          "description": "Indicates if the artist is unavailable for the entire day."
        }
      },
      "required": [
        "id",
        "artistProfileId",
        "unavailableDate"
      ]
    },
    "Subscription": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Subscription",
      "type": "object",
      "description": "Represents a subscription for a venue or artist.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Subscription entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Subscription)"
        },
        "startDate": {
          "type": "string",
          "description": "Date when the subscription started.",
          "format": "date-time"
        },
        "dueDate": {
          "type": "string",
          "description": "Due date for the next payment.",
          "format": "date-time"
        },
        "accountStatus": {
          "type": "string",
          "description": "Status of the account (active/inactive/paused/canceled)."
        },
        "paymentHistory": {
          "type": "array",
          "description": "History of payments for the subscription.",
          "items": {
            "type": "string"
          }
        },
        "paymentStatus": {
          "type": "string",
          "description": "Status of the payment (paid/delinquent)."
        }
      },
      "required": [
        "id",
        "userId",
        "startDate",
        "dueDate",
        "accountStatus",
        "paymentStatus"
      ]
    },
    "Referral": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Referral",
      "type": "object",
      "description": "Represents a referral record.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Referral entity."
        },
        "referrerUserId": {
          "type": "string",
          "description": "Reference to the User who made the referral (optional)."
        },
        "referredUserId": {
          "type": "string",
          "description": "Reference to the User who was referred."
        },
        "referralDate": {
          "type": "string",
          "description": "Date when the referral was made.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "referredUserId",
        "referralDate"
      ]
    },
    "Review": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Review",
        "type": "object",
        "description": "Represents a review of an artist by a venue, or a venue by an artist.",
        "properties": {
            "id": { "type": "string" },
            "bookingRequestId": { "type": "string" },
            "reviewerId": { "type": "string", "description": "The UID of the user leaving the review." },
            "revieweeId": { "type": "string", "description": "The UID of the user being reviewed." },
            "reviewerRole": { "type": "string", "enum": ["artist", "venue"] },
            "rating": { "type": "number", "minimum": 1, "maximum": 5 },
            "reviewText": { "type": "string" },
            "createdAt": { "type": "string", "format": "date-time" }
        },
        "required": ["id", "bookingRequestId", "reviewerId", "revieweeId", "reviewerRole", "rating", "createdAt"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user data. This collection uses path-based ownership. No denormalization is required as access is based on the user's own ID.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/venue_profiles/{venueProfileId}",
        "definition": {
          "entityName": "VenueProfile",
          "schema": {
            "$ref": "#/backend/entities/VenueProfile"
          },
          "description": "Stores venue profiles.  This is a top level collection and would need security rules that determine how the id is set. The profile includes 'userId' which is used for path based ownership validation. Includes denormalized 'userId' field for authorization.",
          "params": [
            {
              "name": "venueProfileId",
              "description": "The unique identifier for the venue profile."
            }
          ]
        }
      },
      {
        "path": "/artist_profiles/{artistProfileId}",
        "definition": {
          "entityName": "ArtistProfile",
          "schema": {
            "$ref": "#/backend/entities/ArtistProfile"
          },
          "description": "Stores artist profiles. The document ID `{artistProfileId}` should be the same as the user's UID. Includes a denormalized `userId` field for authorization.",
          "params": [
            {
              "name": "artistProfileId",
              "description": "The unique identifier for the artist profile, which is also the user's UID."
            }
          ]
        }
      },
      {
        "path": "/venue_profiles/{venueProfileId}/booking_requests/{bookingRequestId}",
        "definition": {
          "entityName": "BookingRequest",
          "schema": {
            "$ref": "#/backend/entities/BookingRequest"
          },
          "description": "Stores booking requests associated with a venue. Includes denormalized 'venueProfileId' for authorization independence.",
          "params": [
            {
              "name": "venueProfileId",
              "description": "The unique identifier for the venue profile."
            },
            {
              "name": "bookingRequestId",
              "description": "The unique identifier for the booking request."
            }
          ]
        }
      },
      {
        "path": "/artist_profiles/{artistProfileId}/availability/{availabilityId}",
        "definition": {
          "entityName": "ArtistAvailability",
          "schema": {
            "$ref": "#/backend/entities/ArtistAvailability"
          },
          "description": "Stores artist availability data. Includes denormalized 'artistProfileId' for authorization independence.",
          "params": [
            {
              "name": "artistProfileId",
              "description": "The unique identifier for the artist profile."
            },
            {
              "name": "availabilityId",
              "description": "The unique identifier for the availability entry."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/subscriptions/{subscriptionId}",
        "definition": {
          "entityName": "Subscription",
          "schema": {
            "$ref": "#/backend/entities/Subscription"
          },
          "description": "Stores subscription information for users. Includes denormalized 'userId' for authorization independence.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "subscriptionId",
              "description": "The unique identifier for the subscription."
            }
          ]
        }
      },
      {
        "path": "/referrals/{referralId}",
        "definition": {
          "entityName": "Referral",
          "schema": {
            "$ref": "#/backend/entities/Referral"
          },
          "description": "Stores referral data. Consider adding an index on `referredUserId` for efficient referral lookups. 'referrerUserId' is optional. Includes 'referredUserId' for authorization.",
          "params": [
            {
              "name": "referralId",
              "description": "The unique identifier for the referral."
            }
          ]
        }
      },
      {
        "path": "/reviews/{reviewId}",
        "definition": {
          "entityName": "Review",
          "schema": {
            "$ref": "#/backend/entities/Review"
          },
          "description": "Stores reviews of artists by venues, or venues by artists. Publicly readable but only writeable by a participant of the booking.",
          "params": [
            {
              "name": "reviewId",
              "description": "The unique identifier for the review."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to support the Vibe Request application's features, prioritizing authorization independence, clarity, and scalability. User and profile data are separated to optimize security and data access. Booking requests, artist availability, and subscriptions are structured to maintain clear relationships and facilitate efficient queries.\n\nAuthorization Independence is achieved through the use of path-based ownership and denormalization. For example, booking requests are stored under the venue profile ID, allowing direct access without needing to fetch parent documents. The denormalization strategy would be critical in the BookingRequest to include the venue's members (if venues could have members other than the owner), or important fields from the ArtistProfile, allowing the rules to authorize the write based on fields in the `request.resource.data` without needing to `get()` other documents. This is key for atomic operations.\n\nQAPs (Rules are not filters) are supported through structural segregation. User-owned data (VenueProfile, ArtistProfile, Subscriptions) are stored in paths unique to the user, enabling secure list operations using path-based rules. Collaborative scenarios, if applicable, would use membership maps denormalized into relevant documents. Booking requests, while associated with both venues and artists, are primarily organized under the venue to simplify access control for venue-related operations, with the option to duplicate relevant data to the artist's profile for efficient artist-side access and filtering."
  }
}
